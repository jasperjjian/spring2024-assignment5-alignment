INFO 06-05 23:45:19 llm_engine.py:161] Initializing an LLM engine (v0.4.3) with config: model='/data/Meta-Llama-3-8B', speculative_config=None, tokenizer='/data/Meta-Llama-3-8B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, rope_scaling=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0, served_model_name=/data/Meta-Llama-3-8B)
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
INFO 06-05 23:45:23 model_runner.py:146] Loading model weights took 14.9595 GB
INFO 06-05 23:45:24 gpu_executor.py:83] # GPU blocks: 27891, # CPU blocks: 2048
INFO 06-05 23:45:25 model_runner.py:854] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 06-05 23:45:25 model_runner.py:858] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 06-05 23:45:27 model_runner.py:924] Graph capturing finished in 2 secs.
Processed prompts:   0%|          | 0/805 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s]Processed prompts:   0%|          | 1/805 [00:00<07:58,  1.68it/s, Generation Speed: 1.68 toks/s]Processed prompts:   0%|          | 2/805 [00:00<04:52,  2.75it/s, Generation Speed: 2.51 toks/s]Processed prompts:   0%|          | 3/805 [00:01<04:00,  3.33it/s, Generation Speed: 2.94 toks/s]Processed prompts:   1%|          | 5/805 [00:01<02:20,  5.69it/s, Generation Speed: 4.23 toks/s]Processed prompts:   1%|          | 7/805 [00:01<01:40,  7.91it/s, Generation Speed: 8.38 toks/s]Processed prompts:   1%|          | 9/805 [00:01<02:18,  5.75it/s, Generation Speed: 23.76 toks/s]Processed prompts:   1%|          | 10/805 [00:02<02:24,  5.52it/s, Generation Speed: 34.69 toks/s]Processed prompts:   1%|▏         | 11/805 [00:02<02:13,  5.95it/s, Generation Speed: 47.14 toks/s]Processed prompts:   1%|▏         | 12/805 [00:02<02:27,  5.38it/s, Generation Speed: 58.78 toks/s]Processed prompts:   2%|▏         | 14/805 [00:02<01:56,  6.80it/s, Generation Speed: 86.44 toks/s]Processed prompts:   2%|▏         | 16/805 [00:02<01:29,  8.84it/s, Generation Speed: 100.32 toks/s]Processed prompts:   2%|▏         | 18/805 [00:02<01:23,  9.39it/s, Generation Speed: 127.90 toks/s]Processed prompts:   2%|▏         | 20/805 [00:03<01:25,  9.18it/s, Generation Speed: 156.28 toks/s]Processed prompts:   3%|▎         | 23/805 [00:03<01:12, 10.81it/s, Generation Speed: 201.49 toks/s]Processed prompts:   3%|▎         | 26/805 [00:03<01:18,  9.91it/s, Generation Speed: 238.34 toks/s]Processed prompts:   4%|▎         | 29/805 [00:03<01:01, 12.57it/s, Generation Speed: 291.58 toks/s]Processed prompts:   4%|▍         | 35/805 [00:03<00:41, 18.66it/s, Generation Speed: 398.89 toks/s]Processed prompts:   5%|▍         | 38/805 [00:04<00:44, 17.23it/s, Generation Speed: 440.03 toks/s]Processed prompts:   5%|▌         | 43/805 [00:04<00:40, 18.76it/s, Generation Speed: 518.75 toks/s]Processed prompts:   6%|▌         | 47/805 [00:04<00:35, 21.31it/s, Generation Speed: 565.79 toks/s]Processed prompts:   7%|▋         | 53/805 [00:04<00:28, 26.60it/s, Generation Speed: 671.90 toks/s]Processed prompts:   7%|▋         | 58/805 [00:04<00:26, 27.76it/s, Generation Speed: 744.15 toks/s]Processed prompts:   8%|▊         | 61/805 [00:04<00:30, 24.42it/s, Generation Speed: 759.50 toks/s]Processed prompts:   8%|▊         | 64/805 [00:05<00:33, 22.28it/s, Generation Speed: 798.40 toks/s]Processed prompts:   9%|▉         | 71/805 [00:05<00:24, 30.56it/s, Generation Speed: 907.50 toks/s]Processed prompts:  10%|▉         | 80/805 [00:05<00:18, 40.27it/s, Generation Speed: 1015.03 toks/s]Processed prompts:  11%|█         | 85/805 [00:05<00:17, 40.99it/s, Generation Speed: 1077.89 toks/s]Processed prompts:  11%|█         | 90/805 [00:05<00:25, 27.90it/s, Generation Speed: 1119.14 toks/s]Processed prompts:  12%|█▏        | 95/805 [00:06<00:26, 27.17it/s, Generation Speed: 1186.88 toks/s]Processed prompts:  12%|█▏        | 99/805 [00:06<00:27, 25.33it/s, Generation Speed: 1234.54 toks/s]Processed prompts:  13%|█▎        | 103/805 [00:06<00:26, 26.52it/s, Generation Speed: 1276.27 toks/s]Processed prompts:  13%|█▎        | 107/805 [00:06<00:26, 26.05it/s, Generation Speed: 1296.81 toks/s]Processed prompts:  14%|█▍        | 111/805 [00:06<00:26, 25.95it/s, Generation Speed: 1322.39 toks/s]Processed prompts:  14%|█▍        | 114/805 [00:06<00:32, 21.55it/s, Generation Speed: 1344.94 toks/s]Processed prompts:  15%|█▍        | 118/805 [00:07<00:30, 22.48it/s, Generation Speed: 1386.40 toks/s]Processed prompts:  15%|█▌        | 121/805 [00:07<00:33, 20.72it/s, Generation Speed: 1416.58 toks/s]Processed prompts:  16%|█▌        | 126/805 [00:07<00:27, 24.57it/s, Generation Speed: 1476.80 toks/s]Processed prompts:  16%|█▌        | 129/805 [00:07<00:27, 24.71it/s, Generation Speed: 1518.21 toks/s]Processed prompts:  16%|█▋        | 132/805 [00:07<00:30, 21.95it/s, Generation Speed: 1547.31 toks/s]Processed prompts:  17%|█▋        | 136/805 [00:07<00:27, 24.45it/s, Generation Speed: 1610.14 toks/s]Processed prompts:  17%|█▋        | 140/805 [00:07<00:25, 26.07it/s, Generation Speed: 1661.18 toks/s]Processed prompts:  18%|█▊        | 143/805 [00:08<00:29, 22.30it/s, Generation Speed: 1666.83 toks/s]Processed prompts:  18%|█▊        | 146/805 [00:08<00:28, 22.74it/s, Generation Speed: 1662.12 toks/s]Processed prompts:  19%|█▊        | 149/805 [00:08<00:28, 22.93it/s, Generation Speed: 1702.17 toks/s]Processed prompts:  19%|█▉        | 154/805 [00:08<00:24, 26.95it/s, Generation Speed: 1748.78 toks/s]Processed prompts:  20%|█▉        | 157/805 [00:08<00:29, 21.86it/s, Generation Speed: 1743.12 toks/s]Processed prompts:  20%|█▉        | 160/805 [00:08<00:30, 21.30it/s, Generation Speed: 1756.41 toks/s]Processed prompts:  20%|██        | 164/805 [00:09<00:27, 23.66it/s, Generation Speed: 1779.78 toks/s]Processed prompts:  21%|██        | 168/805 [00:09<00:24, 25.49it/s, Generation Speed: 1824.28 toks/s]Processed prompts:  21%|██        | 171/805 [00:09<00:27, 23.33it/s, Generation Speed: 1859.09 toks/s]Processed prompts:  22%|██▏       | 174/805 [00:09<00:29, 21.41it/s, Generation Speed: 1891.27 toks/s]Processed prompts:  22%|██▏       | 177/805 [00:09<00:28, 22.22it/s, Generation Speed: 1906.73 toks/s]Processed prompts:  22%|██▏       | 180/805 [00:09<00:31, 20.06it/s, Generation Speed: 1932.84 toks/s]Processed prompts:  23%|██▎       | 183/805 [00:09<00:29, 20.86it/s, Generation Speed: 1949.89 toks/s]Processed prompts:  24%|██▎       | 190/805 [00:10<00:19, 31.24it/s, Generation Speed: 2040.19 toks/s]Processed prompts:  24%|██▍       | 194/805 [00:10<00:19, 31.02it/s, Generation Speed: 2060.77 toks/s]Processed prompts:  25%|██▍       | 198/805 [00:10<00:22, 26.84it/s, Generation Speed: 2080.59 toks/s]Processed prompts:  25%|██▍       | 201/805 [00:10<00:23, 26.02it/s, Generation Speed: 2090.65 toks/s]Processed prompts:  25%|██▌       | 204/805 [00:10<00:28, 21.44it/s, Generation Speed: 2078.27 toks/s]Processed prompts:  26%|██▌       | 207/805 [00:10<00:33, 17.80it/s, Generation Speed: 2070.24 toks/s]Processed prompts:  26%|██▋       | 212/805 [00:11<00:26, 22.17it/s, Generation Speed: 2106.35 toks/s]Processed prompts:  27%|██▋       | 215/805 [00:11<00:25, 22.99it/s, Generation Speed: 2114.17 toks/s]Processed prompts:  27%|██▋       | 219/805 [00:11<00:25, 23.25it/s, Generation Speed: 2104.84 toks/s]Processed prompts:  28%|██▊       | 222/805 [00:11<00:28, 20.37it/s, Generation Speed: 2112.66 toks/s]Processed prompts:  28%|██▊       | 227/805 [00:11<00:22, 25.84it/s, Generation Speed: 2168.47 toks/s]Processed prompts:  29%|██▊       | 230/805 [00:11<00:28, 19.87it/s, Generation Speed: 2174.56 toks/s]Processed prompts:  29%|██▉       | 236/805 [00:12<00:21, 26.30it/s, Generation Speed: 2207.64 toks/s]Processed prompts:  30%|██▉       | 240/805 [00:12<00:22, 24.77it/s, Generation Speed: 2244.27 toks/s]Processed prompts:  30%|███       | 244/805 [00:12<00:21, 26.45it/s, Generation Speed: 2268.83 toks/s]Processed prompts:  31%|███       | 249/805 [00:12<00:19, 29.18it/s, Generation Speed: 2309.22 toks/s]Processed prompts:  31%|███▏      | 253/805 [00:12<00:20, 26.97it/s, Generation Speed: 2322.02 toks/s]Processed prompts:  32%|███▏      | 257/805 [00:12<00:23, 23.57it/s, Generation Speed: 2336.52 toks/s]Processed prompts:  32%|███▏      | 260/805 [00:13<00:23, 23.29it/s, Generation Speed: 2350.45 toks/s]Processed prompts:  33%|███▎      | 263/805 [00:13<00:27, 19.61it/s, Generation Speed: 2353.73 toks/s]Processed prompts:  33%|███▎      | 266/805 [00:13<00:27, 19.49it/s, Generation Speed: 2380.85 toks/s]Processed prompts:  33%|███▎      | 269/805 [00:13<00:39, 13.49it/s, Generation Speed: 2319.45 toks/s]Processed prompts:  34%|███▍      | 273/805 [00:13<00:30, 17.22it/s, Generation Speed: 2326.49 toks/s]Processed prompts:  34%|███▍      | 276/805 [00:14<00:30, 17.29it/s, Generation Speed: 2343.49 toks/s]Processed prompts:  35%|███▍      | 279/805 [00:14<00:30, 17.44it/s, Generation Speed: 2347.14 toks/s]Processed prompts:  35%|███▌      | 284/805 [00:14<00:22, 23.31it/s, Generation Speed: 2371.14 toks/s]Processed prompts:  36%|███▌      | 287/805 [00:14<00:22, 23.34it/s, Generation Speed: 2385.00 toks/s]Processed prompts:  37%|███▋      | 298/805 [00:14<00:12, 39.50it/s, Generation Speed: 2432.33 toks/s]Processed prompts:  38%|███▊      | 303/805 [00:15<00:21, 23.35it/s, Generation Speed: 2433.64 toks/s]Processed prompts:  38%|███▊      | 307/805 [00:15<00:20, 24.48it/s, Generation Speed: 2454.02 toks/s]Processed prompts:  39%|███▊      | 311/805 [00:15<00:18, 26.11it/s, Generation Speed: 2455.69 toks/s]Processed prompts:  39%|███▉      | 315/805 [00:15<00:20, 23.36it/s, Generation Speed: 2457.95 toks/s]Processed prompts:  40%|███▉      | 319/805 [00:15<00:18, 25.84it/s, Generation Speed: 2461.81 toks/s]Processed prompts:  40%|████      | 323/805 [00:15<00:22, 21.03it/s, Generation Speed: 2466.41 toks/s]Processed prompts:  40%|████      | 326/805 [00:16<00:26, 17.82it/s, Generation Speed: 2462.34 toks/s]Processed prompts:  41%|████      | 329/805 [00:16<00:25, 18.69it/s, Generation Speed: 2460.91 toks/s]Processed prompts:  41%|████▏     | 333/805 [00:16<00:23, 20.22it/s, Generation Speed: 2471.33 toks/s]Processed prompts:  42%|████▏     | 336/805 [00:16<00:26, 17.87it/s, Generation Speed: 2492.12 toks/s]Processed prompts:  42%|████▏     | 342/805 [00:16<00:22, 20.18it/s, Generation Speed: 2505.29 toks/s]Processed prompts:  43%|████▎     | 345/805 [00:17<00:24, 18.91it/s, Generation Speed: 2488.65 toks/s]Processed prompts:  43%|████▎     | 347/805 [00:17<00:32, 13.89it/s, Generation Speed: 2458.83 toks/s]Processed prompts:  43%|████▎     | 350/805 [00:17<00:28, 15.69it/s, Generation Speed: 2474.05 toks/s]Processed prompts:  44%|████▎     | 352/805 [00:17<00:30, 14.98it/s, Generation Speed: 2471.65 toks/s]Processed prompts:  44%|████▍     | 355/805 [00:17<00:26, 16.95it/s, Generation Speed: 2479.30 toks/s]Processed prompts:  44%|████▍     | 357/805 [00:18<00:30, 14.91it/s, Generation Speed: 2468.13 toks/s]Processed prompts:  45%|████▍     | 360/805 [00:18<00:28, 15.76it/s, Generation Speed: 2491.14 toks/s]Processed prompts:  45%|████▌     | 364/805 [00:18<00:24, 17.90it/s, Generation Speed: 2510.17 toks/s]Processed prompts:  45%|████▌     | 366/805 [00:18<00:30, 14.18it/s, Generation Speed: 2483.46 toks/s]Processed prompts:  46%|████▌     | 368/805 [00:18<00:31, 13.81it/s, Generation Speed: 2484.75 toks/s]Processed prompts:  46%|████▋     | 373/805 [00:19<00:24, 17.99it/s, Generation Speed: 2505.10 toks/s]Processed prompts:  47%|████▋     | 375/805 [00:19<00:24, 17.92it/s, Generation Speed: 2502.84 toks/s]Processed prompts:  47%|████▋     | 377/805 [00:19<00:24, 17.30it/s, Generation Speed: 2496.73 toks/s]Processed prompts:  47%|████▋     | 379/805 [00:19<00:24, 17.14it/s, Generation Speed: 2491.57 toks/s]Processed prompts:  47%|████▋     | 382/805 [00:19<00:22, 18.82it/s, Generation Speed: 2507.28 toks/s]Processed prompts:  48%|████▊     | 389/805 [00:19<00:15, 26.47it/s, Generation Speed: 2529.61 toks/s]Processed prompts:  49%|████▊     | 392/805 [00:20<00:23, 17.85it/s, Generation Speed: 2507.52 toks/s]Processed prompts:  49%|████▉     | 395/805 [00:20<00:23, 17.56it/s, Generation Speed: 2526.88 toks/s]Processed prompts:  49%|████▉     | 398/805 [00:20<00:21, 18.66it/s, Generation Speed: 2545.52 toks/s]Processed prompts:  50%|████▉     | 401/805 [00:20<00:27, 14.93it/s, Generation Speed: 2532.66 toks/s]Processed prompts:  50%|█████     | 406/805 [00:20<00:19, 20.45it/s, Generation Speed: 2563.52 toks/s]Processed prompts:  51%|█████     | 409/805 [00:20<00:21, 18.61it/s, Generation Speed: 2559.80 toks/s]Processed prompts:  51%|█████     | 412/805 [00:21<00:21, 18.51it/s, Generation Speed: 2548.87 toks/s]Processed prompts:  52%|█████▏    | 415/805 [00:21<00:28, 13.52it/s, Generation Speed: 2511.70 toks/s]Processed prompts:  52%|█████▏    | 419/805 [00:21<00:22, 17.47it/s, Generation Speed: 2529.24 toks/s]Processed prompts:  52%|█████▏    | 422/805 [00:21<00:24, 15.72it/s, Generation Speed: 2504.71 toks/s]Processed prompts:  53%|█████▎    | 425/805 [00:22<00:23, 16.40it/s, Generation Speed: 2497.76 toks/s]Processed prompts:  53%|█████▎    | 427/805 [00:22<00:25, 14.60it/s, Generation Speed: 2483.95 toks/s]Processed prompts:  53%|█████▎    | 429/805 [00:22<00:26, 13.98it/s, Generation Speed: 2489.60 toks/s]Processed prompts:  54%|█████▎    | 431/805 [00:22<00:35, 10.55it/s, Generation Speed: 2475.95 toks/s]Processed prompts:  54%|█████▍    | 434/805 [00:22<00:35, 10.53it/s, Generation Speed: 2456.71 toks/s]Processed prompts:  54%|█████▍    | 438/805 [00:23<00:28, 12.76it/s, Generation Speed: 2462.11 toks/s]Processed prompts:  55%|█████▍    | 440/805 [00:23<00:27, 13.32it/s, Generation Speed: 2477.35 toks/s]Processed prompts:  55%|█████▍    | 442/805 [00:23<00:29, 12.42it/s, Generation Speed: 2473.91 toks/s]Processed prompts:  55%|█████▌    | 444/805 [00:23<00:27, 13.04it/s, Generation Speed: 2482.88 toks/s]Processed prompts:  55%|█████▌    | 446/805 [00:23<00:35, 10.21it/s, Generation Speed: 2469.24 toks/s]Processed prompts:  56%|█████▌    | 448/805 [00:24<00:31, 11.22it/s, Generation Speed: 2462.92 toks/s]Processed prompts:  56%|█████▌    | 451/805 [00:24<00:27, 13.06it/s, Generation Speed: 2455.10 toks/s]Processed prompts:  56%|█████▋    | 453/805 [00:24<00:30, 11.50it/s, Generation Speed: 2437.69 toks/s]Processed prompts:  57%|█████▋    | 456/805 [00:24<00:26, 13.15it/s, Generation Speed: 2445.14 toks/s]Processed prompts:  57%|█████▋    | 460/805 [00:24<00:20, 17.01it/s, Generation Speed: 2471.43 toks/s]Processed prompts:  57%|█████▋    | 462/805 [00:24<00:23, 14.72it/s, Generation Speed: 2461.25 toks/s]Processed prompts:  58%|█████▊    | 464/805 [00:25<00:22, 14.93it/s, Generation Speed: 2460.54 toks/s]Processed prompts:  58%|█████▊    | 466/805 [00:25<00:26, 12.88it/s, Generation Speed: 2449.44 toks/s]Processed prompts:  58%|█████▊    | 468/805 [00:25<00:25, 13.40it/s, Generation Speed: 2437.54 toks/s]Processed prompts:  58%|█████▊    | 470/805 [00:25<00:25, 13.06it/s, Generation Speed: 2425.67 toks/s]Processed prompts:  59%|█████▊    | 472/805 [00:25<00:25, 12.82it/s, Generation Speed: 2428.98 toks/s]Processed prompts:  59%|█████▉    | 476/805 [00:25<00:19, 16.87it/s, Generation Speed: 2429.03 toks/s]Processed prompts:  59%|█████▉    | 478/805 [00:26<00:22, 14.47it/s, Generation Speed: 2421.49 toks/s]Processed prompts:  60%|█████▉    | 480/805 [00:26<00:21, 15.05it/s, Generation Speed: 2440.07 toks/s]Processed prompts:  60%|██████    | 483/805 [00:26<00:32, 10.05it/s, Generation Speed: 2402.59 toks/s]Processed prompts:  60%|██████    | 485/805 [00:26<00:32, 10.00it/s, Generation Speed: 2395.98 toks/s]Processed prompts:  60%|██████    | 487/805 [00:27<00:37,  8.41it/s, Generation Speed: 2382.92 toks/s]Processed prompts:  61%|██████    | 489/805 [00:27<00:43,  7.27it/s, Generation Speed: 2378.27 toks/s]Processed prompts:  61%|██████    | 493/805 [00:27<00:28, 10.81it/s, Generation Speed: 2422.63 toks/s]Processed prompts:  61%|██████▏   | 495/805 [00:28<00:33,  9.26it/s, Generation Speed: 2400.51 toks/s]Processed prompts:  62%|██████▏   | 497/805 [00:28<00:32,  9.36it/s, Generation Speed: 2407.04 toks/s]Processed prompts:  62%|██████▏   | 499/805 [00:28<00:29, 10.41it/s, Generation Speed: 2404.62 toks/s]Processed prompts:  62%|██████▏   | 501/805 [00:28<00:26, 11.35it/s, Generation Speed: 2419.29 toks/s]Processed prompts:  62%|██████▏   | 503/805 [00:28<00:32,  9.32it/s, Generation Speed: 2404.10 toks/s]Processed prompts:  63%|██████▎   | 505/805 [00:29<00:36,  8.21it/s, Generation Speed: 2394.63 toks/s]Processed prompts:  63%|██████▎   | 507/805 [00:29<00:47,  6.33it/s, Generation Speed: 2371.46 toks/s]Processed prompts:  63%|██████▎   | 508/805 [00:29<00:52,  5.66it/s, Generation Speed: 2357.82 toks/s]Processed prompts:  63%|██████▎   | 510/805 [00:30<00:41,  7.11it/s, Generation Speed: 2357.55 toks/s]Processed prompts:  63%|██████▎   | 511/805 [00:30<00:58,  5.02it/s, Generation Speed: 2332.57 toks/s]Processed prompts:  64%|██████▎   | 512/805 [00:31<01:21,  3.60it/s, Generation Speed: 2309.22 toks/s]Processed prompts:  64%|██████▍   | 516/805 [00:31<00:50,  5.69it/s, Generation Speed: 2306.61 toks/s]Processed prompts:  64%|██████▍   | 518/805 [00:31<00:52,  5.49it/s, Generation Speed: 2314.58 toks/s]Processed prompts:  65%|██████▍   | 520/805 [00:32<01:04,  4.43it/s, Generation Speed: 2282.35 toks/s]Processed prompts:  65%|██████▍   | 521/805 [00:32<01:06,  4.28it/s, Generation Speed: 2266.50 toks/s]Processed prompts:  65%|██████▍   | 523/805 [00:33<00:52,  5.38it/s, Generation Speed: 2261.01 toks/s]Processed prompts:  65%|██████▌   | 524/805 [00:33<00:51,  5.51it/s, Generation Speed: 2254.61 toks/s]Processed prompts:  65%|██████▌   | 526/805 [00:33<00:45,  6.18it/s, Generation Speed: 2251.01 toks/s]Processed prompts:  65%|██████▌   | 527/805 [00:33<00:49,  5.58it/s, Generation Speed: 2237.93 toks/s]Processed prompts:  66%|██████▌   | 529/805 [00:33<00:42,  6.53it/s, Generation Speed: 2235.78 toks/s]Processed prompts:  66%|██████▌   | 530/805 [00:34<00:42,  6.43it/s, Generation Speed: 2241.99 toks/s]Processed prompts:  66%|██████▌   | 533/805 [00:34<00:27,  9.97it/s, Generation Speed: 2240.38 toks/s]Processed prompts:  66%|██████▋   | 535/805 [00:34<00:34,  7.94it/s, Generation Speed: 2221.95 toks/s]Processed prompts:  67%|██████▋   | 537/805 [00:34<00:36,  7.25it/s, Generation Speed: 2205.42 toks/s]Processed prompts:  67%|██████▋   | 538/805 [00:34<00:36,  7.33it/s, Generation Speed: 2211.03 toks/s]Processed prompts:  67%|██████▋   | 539/805 [00:35<00:40,  6.63it/s, Generation Speed: 2202.71 toks/s]Processed prompts:  67%|██████▋   | 540/805 [00:35<00:48,  5.42it/s, Generation Speed: 2196.14 toks/s]Processed prompts:  67%|██████▋   | 542/805 [00:35<00:42,  6.13it/s, Generation Speed: 2205.04 toks/s]Processed prompts:  68%|██████▊   | 544/805 [00:36<00:39,  6.68it/s, Generation Speed: 2198.71 toks/s]Processed prompts:  68%|██████▊   | 545/805 [00:36<00:41,  6.19it/s, Generation Speed: 2189.85 toks/s]Processed prompts:  68%|██████▊   | 546/805 [00:36<00:49,  5.27it/s, Generation Speed: 2177.29 toks/s]Processed prompts:  68%|██████▊   | 548/805 [00:36<00:36,  6.98it/s, Generation Speed: 2176.67 toks/s]Processed prompts:  68%|██████▊   | 549/805 [00:36<00:35,  7.12it/s, Generation Speed: 2173.98 toks/s]Processed prompts:  68%|██████▊   | 550/805 [00:37<00:42,  6.01it/s, Generation Speed: 2181.15 toks/s]Processed prompts:  68%|██████▊   | 551/805 [00:37<00:59,  4.29it/s, Generation Speed: 2159.77 toks/s]Processed prompts:  69%|██████▊   | 553/805 [00:37<00:40,  6.21it/s, Generation Speed: 2180.10 toks/s]Processed prompts:  69%|██████▉   | 554/805 [00:37<00:44,  5.58it/s, Generation Speed: 2173.09 toks/s]Processed prompts:  69%|██████▉   | 555/805 [00:37<00:41,  6.08it/s, Generation Speed: 2173.26 toks/s]Processed prompts:  69%|██████▉   | 557/805 [00:38<00:42,  5.90it/s, Generation Speed: 2160.92 toks/s]Processed prompts:  69%|██████▉   | 558/805 [00:38<01:12,  3.42it/s, Generation Speed: 2129.25 toks/s]Processed prompts:  70%|██████▉   | 561/805 [00:39<00:47,  5.17it/s, Generation Speed: 2124.10 toks/s]Processed prompts:  70%|██████▉   | 562/805 [00:39<00:45,  5.36it/s, Generation Speed: 2120.78 toks/s]Processed prompts:  70%|██████▉   | 563/805 [00:39<00:53,  4.49it/s, Generation Speed: 2109.76 toks/s]Processed prompts:  70%|███████   | 567/805 [00:39<00:30,  7.86it/s, Generation Speed: 2122.33 toks/s]Processed prompts:  71%|███████   | 569/805 [00:40<00:25,  9.23it/s, Generation Speed: 2121.29 toks/s]Processed prompts:  71%|███████   | 571/805 [00:40<00:26,  8.98it/s, Generation Speed: 2137.93 toks/s]Processed prompts:  71%|███████   | 573/805 [00:40<00:34,  6.75it/s, Generation Speed: 2124.41 toks/s]Processed prompts:  71%|███████▏  | 574/805 [00:41<00:42,  5.45it/s, Generation Speed: 2109.46 toks/s]Processed prompts:  72%|███████▏  | 576/805 [00:41<00:48,  4.69it/s, Generation Speed: 2090.29 toks/s]Processed prompts:  72%|███████▏  | 577/805 [00:42<01:01,  3.71it/s, Generation Speed: 2073.73 toks/s]Processed prompts:  72%|███████▏  | 579/805 [00:42<00:52,  4.33it/s, Generation Speed: 2071.25 toks/s]Processed prompts:  72%|███████▏  | 580/805 [00:42<00:59,  3.77it/s, Generation Speed: 2055.45 toks/s]Processed prompts:  72%|███████▏  | 581/805 [00:43<00:52,  4.29it/s, Generation Speed: 2054.82 toks/s]Processed prompts:  72%|███████▏  | 582/805 [00:43<00:48,  4.64it/s, Generation Speed: 2052.55 toks/s]Processed prompts:  73%|███████▎  | 585/805 [00:43<00:30,  7.23it/s, Generation Speed: 2058.90 toks/s]Processed prompts:  73%|███████▎  | 586/805 [00:43<00:45,  4.84it/s, Generation Speed: 2040.28 toks/s]Processed prompts:  73%|███████▎  | 587/805 [00:44<00:53,  4.10it/s, Generation Speed: 2029.82 toks/s]Processed prompts:  73%|███████▎  | 588/805 [00:44<00:55,  3.93it/s, Generation Speed: 2025.55 toks/s]Processed prompts:  73%|███████▎  | 591/805 [00:44<00:38,  5.60it/s, Generation Speed: 2028.31 toks/s]Processed prompts:  74%|███████▎  | 592/805 [00:45<00:36,  5.76it/s, Generation Speed: 2043.66 toks/s]Processed prompts:  74%|███████▎  | 593/805 [00:45<00:42,  4.95it/s, Generation Speed: 2035.55 toks/s]Processed prompts:  74%|███████▍  | 594/805 [00:45<00:43,  4.82it/s, Generation Speed: 2035.96 toks/s]Processed prompts:  74%|███████▍  | 595/805 [00:45<00:52,  4.00it/s, Generation Speed: 2041.64 toks/s]Processed prompts:  81%|████████▏ | 656/805 [00:46<00:02, 69.74it/s, Generation Speed: 3367.56 toks/s]Processed prompts:  83%|████████▎ | 665/805 [00:47<00:06, 22.87it/s, Generation Speed: 3411.18 toks/s]Processed prompts:  83%|████████▎ | 672/805 [00:48<00:07, 18.80it/s, Generation Speed: 3507.56 toks/s]Processed prompts:  84%|████████▍ | 677/805 [00:49<00:07, 16.76it/s, Generation Speed: 3563.57 toks/s]Processed prompts:  85%|████████▍ | 681/805 [00:49<00:06, 18.18it/s, Generation Speed: 3625.38 toks/s]Processed prompts:  85%|████████▌ | 685/805 [00:49<00:08, 14.76it/s, Generation Speed: 3668.91 toks/s]Processed prompts:  86%|████████▌ | 689/805 [00:49<00:07, 16.16it/s, Generation Speed: 3726.81 toks/s]Processed prompts:  86%|████████▌ | 692/805 [00:50<00:09, 12.23it/s, Generation Speed: 3747.79 toks/s]Processed prompts:  86%|████████▋ | 695/805 [00:50<00:09, 11.19it/s, Generation Speed: 3781.50 toks/s]Processed prompts:  87%|████████▋ | 697/805 [00:50<00:09, 11.12it/s, Generation Speed: 3807.93 toks/s]Processed prompts:  87%|████████▋ | 699/805 [00:51<00:09, 11.62it/s, Generation Speed: 3837.73 toks/s]Processed prompts:  87%|████████▋ | 701/805 [00:51<00:13,  7.68it/s, Generation Speed: 3832.78 toks/s]Processed prompts:  87%|████████▋ | 703/805 [00:51<00:11,  8.81it/s, Generation Speed: 3863.92 toks/s]Processed prompts:  88%|████████▊ | 705/805 [00:51<00:10,  9.31it/s, Generation Speed: 3890.15 toks/s]Processed prompts:  88%|████████▊ | 707/805 [00:52<00:13,  7.38it/s, Generation Speed: 3897.24 toks/s]Processed prompts:  88%|████████▊ | 709/805 [00:52<00:12,  7.99it/s, Generation Speed: 3921.73 toks/s]Processed prompts:  88%|████████▊ | 712/805 [00:52<00:09, 10.23it/s, Generation Speed: 3968.67 toks/s]Processed prompts:  89%|████████▊ | 714/805 [00:52<00:07, 11.57it/s, Generation Speed: 3999.32 toks/s]Processed prompts:  89%|████████▉ | 718/805 [00:53<00:05, 15.83it/s, Generation Speed: 4067.01 toks/s]Processed prompts:  90%|████████▉ | 721/805 [00:53<00:04, 18.44it/s, Generation Speed: 4116.88 toks/s]Processed prompts:  90%|████████▉ | 724/805 [00:53<00:05, 14.63it/s, Generation Speed: 4151.32 toks/s]Processed prompts:  90%|█████████ | 726/805 [00:53<00:06, 12.22it/s, Generation Speed: 4169.73 toks/s]Processed prompts:  91%|█████████ | 729/805 [00:53<00:05, 13.13it/s, Generation Speed: 4211.76 toks/s]Processed prompts:  92%|█████████▏| 737/805 [00:53<00:02, 23.81it/s, Generation Speed: 4354.42 toks/s]Processed prompts:  92%|█████████▏| 741/805 [00:54<00:03, 19.10it/s, Generation Speed: 4404.68 toks/s]Processed prompts:  92%|█████████▏| 744/805 [00:54<00:03, 18.84it/s, Generation Speed: 4443.25 toks/s]Processed prompts:  93%|█████████▎| 747/805 [00:54<00:02, 19.70it/s, Generation Speed: 4488.84 toks/s]Processed prompts:  93%|█████████▎| 752/805 [00:54<00:02, 24.23it/s, Generation Speed: 4572.02 toks/s]Processed prompts:  94%|█████████▍| 757/805 [00:54<00:01, 24.15it/s, Generation Speed: 4647.90 toks/s]Processed prompts:  94%|█████████▍| 760/805 [00:55<00:02, 22.04it/s, Generation Speed: 4688.81 toks/s]Processed prompts:  95%|█████████▍| 763/805 [00:55<00:02, 17.65it/s, Generation Speed: 4721.14 toks/s]Processed prompts:  95%|█████████▌| 766/805 [00:55<00:02, 16.62it/s, Generation Speed: 4758.55 toks/s]Processed prompts:  95%|█████████▌| 768/805 [00:55<00:02, 15.48it/s, Generation Speed: 4781.21 toks/s]Processed prompts:  96%|█████████▌| 772/805 [00:55<00:01, 19.19it/s, Generation Speed: 4844.21 toks/s]Processed prompts:  96%|█████████▋| 775/805 [00:55<00:01, 21.30it/s, Generation Speed: 4890.35 toks/s]Processed prompts:  97%|█████████▋| 778/805 [00:56<00:01, 18.46it/s, Generation Speed: 4926.16 toks/s]Processed prompts:  97%|█████████▋| 781/805 [00:56<00:01, 18.05it/s, Generation Speed: 4965.34 toks/s]Processed prompts:  97%|█████████▋| 783/805 [00:56<00:01, 18.28it/s, Generation Speed: 4992.44 toks/s]Processed prompts:  98%|█████████▊| 785/805 [00:56<00:01, 17.69it/s, Generation Speed: 5017.62 toks/s]Processed prompts:  98%|█████████▊| 790/805 [00:56<00:00, 22.89it/s, Generation Speed: 5095.28 toks/s]Processed prompts:  99%|█████████▊| 793/805 [00:57<00:00, 17.28it/s, Generation Speed: 5123.95 toks/s]Processed prompts:  99%|█████████▉| 796/805 [00:57<00:00, 18.32it/s, Generation Speed: 5165.22 toks/s]Processed prompts:  99%|█████████▉| 799/805 [00:57<00:00,  9.32it/s, Generation Speed: 5155.13 toks/s]Processed prompts: 100%|█████████▉| 801/805 [00:58<00:00,  6.99it/s, Generation Speed: 5142.13 toks/s]Processed prompts: 100%|█████████▉| 803/805 [00:58<00:00,  6.32it/s, Generation Speed: 5140.71 toks/s]Processed prompts: 100%|█████████▉| 804/805 [00:58<00:00,  6.30it/s, Generation Speed: 5144.04 toks/s]Processed prompts: 100%|██████████| 805/805 [00:59<00:00, 13.63it/s, Generation Speed: 5154.86 toks/s]
WARNING:root:precomputed_leaderboard = 'auto'. But we have found no corresponding leaderboard
/home/c-jjian/miniconda3/envs/cs336_alignment/lib/python3.10/site-packages/datasets/load.py:1491: FutureWarning: The repository for tatsu-lab/alpaca_eval contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/tatsu-lab/alpaca_eval
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Downloading builder script:   0%|          | 0.00/8.10k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 8.10k/8.10k [00:00<00:00, 54.5MB/s]
Downloading readme:   0%|          | 0.00/30.0 [00:00<?, ?B/s]Downloading readme: 100%|██████████| 30.0/30.0 [00:00<00:00, 410kB/s]
Downloading data:   0%|          | 0.00/1.90M [00:00<?, ?B/s]Downloading data:  21%|██        | 394k/1.90M [00:00<00:00, 3.91MB/s]Downloading data: 100%|██████████| 1.90M/1.90M [00:00<00:00, 12.0MB/s]
/home/c-jjian/.cache/huggingface/datasets/downloads/f7137a1c6a1a476bded352abb81785f6a2f318f72e842f7f69a0169ca6c9b4fe
Generating eval split: 0 examples [00:00, ? examples/s]Generating eval split: 805 examples [00:00, 17341.45 examples/s]
INFO:root:Evaluating the llama-3-8b-base outputs.
INFO:root:Creating the annotator from `scripts/alpaca_eval_vllm_llama3_70b_fn`.
INFO:root:Saving annotations to `scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json`.
Annotation chunk:   0%|          | 0/7 [00:00<?, ?it/s]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn
INFO:root:vllm: loading model: /home/shared/Meta-Llama-3-70B-Instruct, tp=2, trust_remote_code=1
2024-06-05 23:46:35,037	INFO worker.py:1749 -- Started a local Ray instance.
INFO 06-05 23:46:49 llm_engine.py:161] Initializing an LLM engine (v0.4.3) with config: model='/home/shared/Meta-Llama-3-70B-Instruct', speculative_config=None, tokenizer='/home/shared/Meta-Llama-3-70B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, rope_scaling=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=7000, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=2, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0, served_model_name=/home/shared/Meta-Llama-3-70B-Instruct)
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
INFO 06-05 23:46:54 utils.py:618] Found nccl from library libnccl.so.2
INFO 06-05 23:46:54 pynccl.py:65] vLLM is using nccl==2.20.5
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:46:54 utils.py:618] Found nccl from library libnccl.so.2
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:46:54 pynccl.py:65] vLLM is using nccl==2.20.5
INFO 06-05 23:46:54 custom_all_reduce_utils.py:169] generating GPU P2P access cache for in /home/c-jjian/.config/vllm/gpu_p2p_access_cache_for_0,1.json
INFO 06-05 23:47:13 custom_all_reduce_utils.py:179] reading GPU P2P access cache from /home/c-jjian/.config/vllm/gpu_p2p_access_cache_for_0,1.json
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:47:13 custom_all_reduce_utils.py:179] reading GPU P2P access cache from /home/c-jjian/.config/vllm/gpu_p2p_access_cache_for_0,1.json
INFO 06-05 23:47:35 model_runner.py:146] Loading model weights took 65.7114 GB
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:47:42 model_runner.py:146] Loading model weights took 65.7114 GB
INFO 06-05 23:47:44 distributed_gpu_executor.py:56] # GPU blocks: 643, # CPU blocks: 1638
INFO 06-05 23:47:46 model_runner.py:854] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 06-05 23:47:46 model_runner.py:858] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:47:46 model_runner.py:854] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:47:46 model_runner.py:858] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 06-05 23:47:51 custom_all_reduce.py:260] Registering 5635 cuda graph addresses
INFO 06-05 23:47:51 model_runner.py:924] Graph capturing finished in 5 secs.
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:47:51 custom_all_reduce.py:260] Registering 5635 cuda graph addresses
[36m(RayWorkerWrapper pid=3163871)[0m INFO 06-05 23:47:51 model_runner.py:924] Graph capturing finished in 5 secs.

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<05:01,  2.37s/it, Generation Speed: 13.90 toks/s][AWARNING 06-05 23:47:56 scheduler.py:1077] Sequence group 18 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1

Processed prompts:   8%|▊         | 10/128 [00:04<00:50,  2.34it/s, Generation Speed: 67.67 toks/s][A
Processed prompts:   9%|▊         | 11/128 [00:05<00:48,  2.41it/s, Generation Speed: 69.75 toks/s][A
Processed prompts:  15%|█▍        | 19/128 [00:07<00:33,  3.24it/s, Generation Speed: 88.49 toks/s][A
Processed prompts:  16%|█▌        | 20/128 [00:07<00:34,  3.09it/s, Generation Speed: 87.33 toks/s][A
Processed prompts:  23%|██▎       | 29/128 [00:09<00:28,  3.49it/s, Generation Speed: 97.01 toks/s][A
Processed prompts:  29%|██▉       | 37/128 [00:12<00:26,  3.41it/s, Generation Speed: 99.36 toks/s][A
Processed prompts:  34%|███▍      | 44/128 [00:14<00:26,  3.23it/s, Generation Speed: 98.88 toks/s][A
Processed prompts:  41%|████      | 52/128 [00:17<00:23,  3.29it/s, Generation Speed: 100.73 toks/s][A
Processed prompts:  47%|████▋     | 60/128 [00:19<00:20,  3.35it/s, Generation Speed: 102.37 toks/s][A
Processed prompts:  52%|█████▏    | 67/128 [00:21<00:19,  3.19it/s, Generation Speed: 101.47 toks/s][A
Processed prompts:  59%|█████▊    | 75/128 [00:22<00:13,  4.03it/s, Generation Speed: 109.10 toks/s][A
Processed prompts:  59%|█████▉    | 76/128 [00:24<00:17,  3.04it/s, Generation Speed: 102.80 toks/s][A
Processed prompts:  66%|██████▋   | 85/128 [00:26<00:13,  3.30it/s, Generation Speed: 104.66 toks/s][A
Processed prompts:  73%|███████▎  | 94/128 [00:28<00:08,  4.14it/s, Generation Speed: 110.61 toks/s][A
Processed prompts:  74%|███████▍  | 95/128 [00:29<00:10,  3.30it/s, Generation Speed: 106.68 toks/s][A
Processed prompts:  79%|███████▉  | 101/128 [00:30<00:07,  3.82it/s, Generation Speed: 109.48 toks/s][A
Processed prompts:  80%|███████▉  | 102/128 [00:31<00:08,  3.00it/s, Generation Speed: 106.16 toks/s][A
Processed prompts:  84%|████████▍ | 108/128 [00:32<00:05,  3.64it/s, Generation Speed: 108.73 toks/s][A
Processed prompts:  86%|████████▌ | 110/128 [00:34<00:06,  3.00it/s, Generation Speed: 106.46 toks/s][A
Processed prompts:  91%|█████████▏| 117/128 [00:35<00:02,  3.88it/s, Generation Speed: 109.66 toks/s][A
Processed prompts:  92%|█████████▏| 118/128 [00:36<00:03,  2.92it/s, Generation Speed: 106.66 toks/s][A
Processed prompts:  97%|█████████▋| 124/128 [00:37<00:00,  4.12it/s, Generation Speed: 110.27 toks/s][A
Processed prompts:  98%|█████████▊| 125/128 [00:38<00:00,  3.22it/s, Generation Speed: 108.22 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:38<00:00,  3.36it/s, Generation Speed: 110.80 toks/s]
ERROR:root:malformed node or string on line 3: <ast.Name object at 0x149149e08400>
Content: [
    {'model': 'model_1', 'rank': 1},
    {'model': 'model_2',styleType: 2}
]
You must manually fix the score pair.
WARNING:root:1 samples had no auto annotation. We are filtering them for now. If you are using chain of thought it might be that max_tokens limit is too low. 
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  14%|█▍        | 1/7 [01:56<11:39, 116.62s/it]INFO:root:Annotating 127 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/127 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/127 [00:02<04:52,  2.32s/it, Generation Speed: 14.21 toks/s][A
Processed prompts:   7%|▋         | 9/127 [00:04<00:55,  2.15it/s, Generation Speed: 62.49 toks/s][A
Processed prompts:  15%|█▍        | 19/127 [00:06<00:31,  3.39it/s, Generation Speed: 94.13 toks/s][A
Processed prompts:  16%|█▌        | 20/127 [00:07<00:34,  3.07it/s, Generation Speed: 89.98 toks/s][A
Processed prompts:  22%|██▏       | 28/127 [00:09<00:30,  3.21it/s, Generation Speed: 95.19 toks/s][A
Processed prompts:  28%|██▊       | 35/127 [00:12<00:29,  3.14it/s, Generation Speed: 96.09 toks/s][A
Processed prompts:  35%|███▍      | 44/127 [00:14<00:24,  3.38it/s, Generation Speed: 101.00 toks/s][A
Processed prompts:  41%|████      | 52/127 [00:16<00:21,  3.49it/s, Generation Speed: 103.81 toks/s][A
Processed prompts:  46%|████▋     | 59/127 [00:18<00:20,  3.29it/s, Generation Speed: 102.79 toks/s][A
Processed prompts:  51%|█████     | 65/127 [00:20<00:18,  3.29it/s, Generation Speed: 103.28 toks/s][A
Processed prompts:  52%|█████▏    | 66/127 [00:21<00:20,  2.94it/s, Generation Speed: 100.51 toks/s][A
Processed prompts:  58%|█████▊    | 74/127 [00:23<00:14,  3.58it/s, Generation Speed: 105.28 toks/s][A
Processed prompts:  59%|█████▉    | 75/127 [00:24<00:16,  3.08it/s, Generation Speed: 102.52 toks/s][A
Processed prompts:  65%|██████▍   | 82/127 [00:25<00:12,  3.58it/s, Generation Speed: 105.59 toks/s][A
Processed prompts:  66%|██████▌   | 84/127 [00:26<00:13,  3.27it/s, Generation Speed: 104.35 toks/s][A
Processed prompts:  71%|███████   | 90/127 [00:27<00:10,  3.68it/s, Generation Speed: 106.62 toks/s][A
Processed prompts:  73%|███████▎  | 93/127 [00:28<00:09,  3.45it/s, Generation Speed: 106.11 toks/s][A
Processed prompts:  77%|███████▋  | 98/127 [00:30<00:08,  3.59it/s, Generation Speed: 107.07 toks/s][A
Processed prompts:  79%|███████▊  | 100/127 [00:31<00:08,  3.14it/s, Generation Speed: 105.57 toks/s][A
Processed prompts:  82%|████████▏ | 104/127 [00:32<00:07,  3.21it/s, Generation Speed: 105.76 toks/s][A
Processed prompts:  84%|████████▍ | 107/127 [00:33<00:06,  3.05it/s, Generation Speed: 105.17 toks/s][A
Processed prompts:  88%|████████▊ | 112/127 [00:34<00:04,  3.44it/s, Generation Speed: 106.47 toks/s][A
Processed prompts:  90%|████████▉ | 114/127 [00:35<00:04,  2.87it/s, Generation Speed: 104.64 toks/s][A
Processed prompts:  93%|█████████▎| 118/127 [00:37<00:02,  3.03it/s, Generation Speed: 104.89 toks/s][A
Processed prompts:  94%|█████████▍| 120/127 [00:37<00:02,  3.42it/s, Generation Speed: 105.89 toks/s][A
Processed prompts:  95%|█████████▌| 121/127 [00:37<00:01,  3.07it/s, Generation Speed: 105.19 toks/s][A
Processed prompts:  99%|█████████▉| 126/127 [00:38<00:00,  4.65it/s, Generation Speed: 108.28 toks/s][AProcessed prompts: 100%|██████████| 127/127 [00:38<00:00,  3.31it/s, Generation Speed: 109.12 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  29%|██▊       | 2/7 [02:35<05:54, 70.86s/it] INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<05:06,  2.41s/it, Generation Speed: 13.69 toks/s][A
Processed prompts:   8%|▊         | 10/128 [00:04<00:49,  2.41it/s, Generation Speed: 69.45 toks/s][A
Processed prompts:  14%|█▍        | 18/128 [00:07<00:37,  2.91it/s, Generation Speed: 84.79 toks/s][A
Processed prompts:  20%|█▉        | 25/128 [00:09<00:35,  2.94it/s, Generation Speed: 88.15 toks/s][A
Processed prompts:  27%|██▋       | 34/128 [00:11<00:28,  3.25it/s, Generation Speed: 95.66 toks/s][A
Processed prompts:  34%|███▎      | 43/128 [00:14<00:24,  3.41it/s, Generation Speed: 100.28 toks/s][A
Processed prompts:  40%|███▉      | 51/128 [00:16<00:21,  3.63it/s, Generation Speed: 104.75 toks/s][A
Processed prompts:  41%|████      | 52/128 [00:16<00:22,  3.43it/s, Generation Speed: 103.15 toks/s][A
Processed prompts:  45%|████▌     | 58/128 [00:18<00:21,  3.33it/s, Generation Speed: 103.21 toks/s][A
Processed prompts:  46%|████▌     | 59/128 [00:19<00:21,  3.20it/s, Generation Speed: 102.37 toks/s][A
Processed prompts:  52%|█████▏    | 67/128 [00:21<00:18,  3.26it/s, Generation Speed: 103.26 toks/s][A
Processed prompts:  59%|█████▊    | 75/128 [00:23<00:16,  3.27it/s, Generation Speed: 103.78 toks/s][A
Processed prompts:  66%|██████▋   | 85/128 [00:26<00:11,  3.59it/s, Generation Speed: 106.87 toks/s][A
Processed prompts:  73%|███████▎  | 93/128 [00:28<00:09,  3.55it/s, Generation Speed: 107.46 toks/s][A
Processed prompts:  78%|███████▊  | 100/128 [00:31<00:08,  3.32it/s, Generation Speed: 106.44 toks/s][A
Processed prompts:  85%|████████▌ | 109/128 [00:33<00:05,  3.57it/s, Generation Speed: 108.47 toks/s][A
Processed prompts:  91%|█████████ | 116/128 [00:35<00:03,  3.34it/s, Generation Speed: 107.50 toks/s][A
Processed prompts:  97%|█████████▋| 124/128 [00:36<00:00,  4.05it/s, Generation Speed: 111.66 toks/s][A
Processed prompts:  98%|█████████▊| 125/128 [00:37<00:00,  3.78it/s, Generation Speed: 110.79 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:37<00:00,  3.44it/s, Generation Speed: 113.43 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  43%|████▎     | 3/7 [03:13<03:42, 55.74s/it]INFO:root:Annotating 127 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/127 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/127 [00:02<05:12,  2.48s/it, Generation Speed: 13.31 toks/s][A
Processed prompts:   9%|▊         | 11/127 [00:04<00:37,  3.08it/s, Generation Speed: 86.17 toks/s][A
Processed prompts:   9%|▉         | 12/127 [00:05<00:44,  2.56it/s, Generation Speed: 77.62 toks/s][A
Processed prompts:  17%|█▋        | 21/127 [00:06<00:27,  3.81it/s, Generation Speed: 103.40 toks/s][A
Processed prompts:  17%|█▋        | 22/127 [00:07<00:32,  3.26it/s, Generation Speed: 97.21 toks/s] [A
Processed prompts:  24%|██▎       | 30/127 [00:09<00:25,  3.85it/s, Generation Speed: 107.98 toks/s][A
Processed prompts:  24%|██▍       | 31/127 [00:09<00:27,  3.43it/s, Generation Speed: 104.18 toks/s][A
Processed prompts:  32%|███▏      | 41/127 [00:12<00:22,  3.79it/s, Generation Speed: 110.75 toks/s][A
Processed prompts:  42%|████▏     | 53/127 [00:14<00:17,  4.28it/s, Generation Speed: 119.49 toks/s][A
Processed prompts:  50%|████▉     | 63/127 [00:17<00:15,  4.20it/s, Generation Speed: 121.64 toks/s][A
Processed prompts:  57%|█████▋    | 72/127 [00:19<00:13,  4.20it/s, Generation Speed: 123.49 toks/s][A
Processed prompts:  57%|█████▋    | 73/127 [00:19<00:13,  4.05it/s, Generation Speed: 122.51 toks/s][A
Processed prompts:  65%|██████▍   | 82/127 [00:21<00:10,  4.36it/s, Generation Speed: 126.06 toks/s][A
Processed prompts:  65%|██████▌   | 83/127 [00:22<00:10,  4.00it/s, Generation Speed: 124.19 toks/s][A
Processed prompts:  70%|███████   | 89/127 [00:23<00:10,  3.74it/s, Generation Speed: 122.99 toks/s][A
Processed prompts:  71%|███████   | 90/127 [00:24<00:10,  3.58it/s, Generation Speed: 122.20 toks/s][A
Processed prompts:  76%|███████▋  | 97/127 [00:26<00:08,  3.51it/s, Generation Speed: 121.47 toks/s][A
Processed prompts:  77%|███████▋  | 98/127 [00:26<00:08,  3.27it/s, Generation Speed: 120.23 toks/s][A
Processed prompts:  83%|████████▎ | 106/127 [00:28<00:04,  4.29it/s, Generation Speed: 124.37 toks/s][A
Processed prompts:  84%|████████▍ | 107/127 [00:29<00:05,  3.35it/s, Generation Speed: 120.94 toks/s][A
Processed prompts:  90%|████████▉ | 114/127 [00:30<00:03,  3.93it/s, Generation Speed: 123.02 toks/s][A
Processed prompts:  91%|█████████ | 115/127 [00:31<00:03,  3.24it/s, Generation Speed: 120.52 toks/s][A
Processed prompts:  97%|█████████▋| 123/127 [00:33<00:01,  3.72it/s, Generation Speed: 121.86 toks/s][AProcessed prompts: 100%|██████████| 127/127 [00:33<00:00,  3.81it/s, Generation Speed: 125.81 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  57%|█████▋    | 4/7 [03:46<02:21, 47.05s/it]INFO:root:Annotating 128 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/128 [00:02<04:53,  2.31s/it, Generation Speed: 14.26 toks/s][A
Processed prompts:   8%|▊         | 10/128 [00:04<00:47,  2.48it/s, Generation Speed: 71.60 toks/s][A
Processed prompts:  14%|█▍        | 18/128 [00:07<00:38,  2.88it/s, Generation Speed: 84.76 toks/s][A
Processed prompts:  21%|██        | 27/128 [00:09<00:31,  3.23it/s, Generation Speed: 94.75 toks/s][A
Processed prompts:  27%|██▋       | 34/128 [00:11<00:29,  3.17it/s, Generation Speed: 95.94 toks/s][A
Processed prompts:  33%|███▎      | 42/128 [00:14<00:26,  3.20it/s, Generation Speed: 97.92 toks/s][A
Processed prompts:  40%|███▉      | 51/128 [00:16<00:22,  3.36it/s, Generation Speed: 101.46 toks/s][A
Processed prompts:  47%|████▋     | 60/128 [00:17<00:16,  4.04it/s, Generation Speed: 110.26 toks/s][A
Processed prompts:  48%|████▊     | 61/128 [00:18<00:19,  3.49it/s, Generation Speed: 106.13 toks/s][A
Processed prompts:  53%|█████▎    | 68/128 [00:21<00:18,  3.25it/s, Generation Speed: 104.82 toks/s][A
Processed prompts:  59%|█████▊    | 75/128 [00:23<00:15,  3.39it/s, Generation Speed: 106.31 toks/s][A
Processed prompts:  59%|█████▉    | 76/128 [00:24<00:16,  3.08it/s, Generation Speed: 104.28 toks/s][A
Processed prompts:  65%|██████▍   | 83/128 [00:25<00:12,  3.62it/s, Generation Speed: 107.62 toks/s][A
Processed prompts:  66%|██████▌   | 84/128 [00:26<00:14,  3.10it/s, Generation Speed: 105.14 toks/s][A
Processed prompts:  70%|███████   | 90/128 [00:27<00:10,  3.53it/s, Generation Speed: 107.29 toks/s][A
Processed prompts:  72%|███████▏  | 92/128 [00:28<00:11,  3.19it/s, Generation Speed: 106.00 toks/s][A
Processed prompts:  76%|███████▌  | 97/128 [00:29<00:09,  3.42it/s, Generation Speed: 107.02 toks/s][A
Processed prompts:  78%|███████▊  | 100/128 [00:31<00:08,  3.22it/s, Generation Speed: 106.39 toks/s][A
Processed prompts:  82%|████████▏ | 105/128 [00:32<00:06,  3.48it/s, Generation Speed: 107.43 toks/s][A
Processed prompts:  86%|████████▌ | 110/128 [00:33<00:04,  3.73it/s, Generation Speed: 108.69 toks/s][A
Processed prompts:  90%|████████▉ | 115/128 [00:34<00:03,  3.98it/s, Generation Speed: 110.06 toks/s][A
Processed prompts:  93%|█████████▎| 119/128 [00:35<00:02,  3.67it/s, Generation Speed: 109.69 toks/s][A
Processed prompts:  95%|█████████▌| 122/128 [00:36<00:01,  3.61it/s, Generation Speed: 109.75 toks/s][A
Processed prompts:  98%|█████████▊| 126/128 [00:37<00:00,  4.29it/s, Generation Speed: 111.77 toks/s][AProcessed prompts: 100%|██████████| 128/128 [00:37<00:00,  3.44it/s, Generation Speed: 113.53 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  71%|███████▏  | 5/7 [04:24<01:27, 43.66s/it]INFO:root:Annotating 127 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/127 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   1%|          | 1/127 [00:02<04:54,  2.34s/it, Generation Speed: 14.10 toks/s][A
Processed prompts:   6%|▋         | 8/127 [00:04<01:01,  1.94it/s, Generation Speed: 56.46 toks/s][A
Processed prompts:  12%|█▏        | 15/127 [00:06<00:45,  2.46it/s, Generation Speed: 71.39 toks/s][A
Processed prompts:  18%|█▊        | 23/127 [00:09<00:37,  2.81it/s, Generation Speed: 81.27 toks/s][A
Processed prompts:  27%|██▋       | 34/127 [00:11<00:27,  3.44it/s, Generation Speed: 95.29 toks/s][A
Processed prompts:  33%|███▎      | 42/127 [00:13<00:23,  3.65it/s, Generation Speed: 101.10 toks/s][A
Processed prompts:  34%|███▍      | 43/127 [00:14<00:24,  3.41it/s, Generation Speed: 99.06 toks/s] [A
Processed prompts:  41%|████      | 52/127 [00:16<00:19,  3.90it/s, Generation Speed: 106.14 toks/s][A
Processed prompts:  43%|████▎     | 54/127 [00:16<00:18,  3.97it/s, Generation Speed: 107.31 toks/s][A
Processed prompts:  48%|████▊     | 61/127 [00:18<00:18,  3.55it/s, Generation Speed: 106.32 toks/s][A
Processed prompts:  54%|█████▍    | 69/127 [00:21<00:16,  3.49it/s, Generation Speed: 106.95 toks/s][A
Processed prompts:  62%|██████▏   | 79/127 [00:23<00:12,  3.81it/s, Generation Speed: 110.67 toks/s][A
Processed prompts:  70%|███████   | 89/127 [00:26<00:09,  3.91it/s, Generation Speed: 112.93 toks/s][A
Processed prompts:  77%|███████▋  | 98/127 [00:27<00:06,  4.28it/s, Generation Speed: 116.86 toks/s][A
Processed prompts:  78%|███████▊  | 99/127 [00:28<00:07,  3.76it/s, Generation Speed: 114.30 toks/s][A
Processed prompts:  83%|████████▎ | 106/127 [00:30<00:05,  4.00it/s, Generation Speed: 116.19 toks/s][A
Processed prompts:  84%|████████▍ | 107/127 [00:30<00:05,  3.54it/s, Generation Speed: 114.39 toks/s][A
Processed prompts:  91%|█████████▏| 116/127 [00:33<00:03,  3.61it/s, Generation Speed: 114.93 toks/s][A
Processed prompts:  99%|█████████▉| 126/127 [00:34<00:00,  5.03it/s, Generation Speed: 121.62 toks/s][A
Processed prompts: 100%|██████████| 127/127 [00:34<00:00,  4.63it/s, Generation Speed: 120.79 toks/s][AProcessed prompts: 100%|██████████| 127/127 [00:34<00:00,  3.66it/s, Generation Speed: 120.79 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk:  86%|████████▌ | 6/7 [04:59<00:40, 40.79s/it]INFO:root:Annotating 37 examples with alpaca_eval_vllm_llama3_70b_fn

Processed prompts:   0%|          | 0/37 [00:00<?, ?it/s, Generation Speed: 0.00 toks/s][A
Processed prompts:   3%|▎         | 1/37 [00:02<01:24,  2.34s/it, Generation Speed: 14.13 toks/s][A
Processed prompts:  24%|██▍       | 9/37 [00:04<00:12,  2.19it/s, Generation Speed: 63.63 toks/s][A
Processed prompts:  46%|████▌     | 17/37 [00:07<00:07,  2.71it/s, Generation Speed: 79.10 toks/s][A
Processed prompts:  68%|██████▊   | 25/37 [00:08<00:03,  3.44it/s, Generation Speed: 95.50 toks/s][A
Processed prompts:  70%|███████   | 26/37 [00:09<00:03,  2.92it/s, Generation Speed: 89.04 toks/s][A
Processed prompts:  92%|█████████▏| 34/37 [00:10<00:00,  4.38it/s, Generation Speed: 108.13 toks/s][A
Processed prompts:  95%|█████████▍| 35/37 [00:11<00:00,  3.70it/s, Generation Speed: 103.51 toks/s][AProcessed prompts: 100%|██████████| 37/37 [00:11<00:00,  3.31it/s, Generation Speed: 109.38 toks/s]
INFO:root:Saving all annotations to scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
INFO:root:Loading all annotations from scripts/alpaca_eval_vllm_llama3_70b_fn/annotations_seed0_configs.json.
Annotation chunk: 100%|██████████| 7/7 [05:11<00:00, 31.17s/it]Annotation chunk: 100%|██████████| 7/7 [05:11<00:00, 44.45s/it]
INFO:root:drop 1 outputs that are not preferences
INFO:root:drop 1 outputs that are not preferences
INFO:root:Saving all results to /home/c-jjian/assignments/spring2024-assignment5-alignment/results/alpaca_eval
INFO:root:Not saving the result to the cached leaderboard because precomputed_leaderboard is not a path but <class 'NoneType'>.
                 length_controlled_winrate  win_rate  standard_error  n_total  avg_length
llama-3-8b-base                       1.21      1.55            0.42      804        1697
[rank0]:[W CudaIPCTypes.cpp:16] Producer process has been terminated before all shared CUDA tensors released. See Note [Sharing CUDA tensors]
